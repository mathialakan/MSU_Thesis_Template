%%%%%%%%%%%%%% MSU Dissertation  %%%%%%%%%%%%%%%%%%

\typeout{  }
\typeout{Substyle `rac' for Rackham dissertation.}
\typeout{  }

%-- Page styles --

\def\ps@chappage{% The first page of each chapter has bottom-center page numbers -jj.
 \def\@oddhead{}
 \def\@oddfoot{\hfil \rm \thepage \hfil}
 \let\@evenhead\@oddhead 
 \let\@evenfoot\@oddfoot
}

\def\ps@plain{%
% \def\@oddhead{\hfil \rm \thepage \hfil} % These two lines of code make top-center page numbers on other pages -jg
% \def\@oddfoot{}
 \def\@oddhead{} % These two lines of code make bottom-center page numbers on other pages -jg
 \def\@oddfoot{\hfil \rm \thepage \hfil}
 \let\@evenhead\@oddhead 
 \let\@evenfoot\@oddfoot
}

%-- Margins --
\if@twoside \oddsidemargin 0in \evensidemargin 0in \marginparwidth .6in \textheight=9in
\else \oddsidemargin 0in \marginparwidth 0.6in \textheight=9.0in\fi% left margin=1in + oddsidemargin, marginparwidth: text box for margin notes
\topmargin -.7in \headheight 0.35in \headsep 0.35in \footskip 0.5in % header and footer margins
\textwidth=6.5in % width of the text body on a page
% The top margin = 1in plus vspace. For some reason, need to subtract 0.35in also.
\def\vertadjust{\vspace{-0.35in}} % Required for proper vertical spacing. -jg
\def\twoinmar{\vertadjust\vspace{1.0in}} % Two inch top margin -jg
\def\twohalfinmar{\vertadjust\vspace{1.5in}} % Two and a half inch top margin -jg

%-- Front pages --

% jj: This \ttlpg is the same as \titlepage in report.sty.
\def\ttlpg{\@restonecolfalse \if@twocolumn \@restonecoltrue \onecolumn
 \else \newpage \fi \thispagestyle{empty} \c@page \z@}

%%% Title Page %%%
\def\titlepage#1#2#3#4#5{
 \ttlpg

 \hbox{ }
 \vspace{0.5in}
 %\twoinmar
 \begin{center}
 \begin{singlespace}
  \MakeUppercase{#1}\\
  \end{singlespace}
 %\begin{onehalfspacing} % For the `Large' font size, this will look single spaced. -jg
 % {\Large\bf #1 \mbox{}} \\
 %\end{onehalfspacing}
  %\vfill
  \doublespacing
  By \\
  %\vspace{2ex} % ex is the height of the lowercase 'x' for the current font. -jg
  \doublespacing
  #2 \\
  %\vfill
  \vspace{3.7in}
  A DISSERTATION\\
  \doublespacing
  %need to comment out later
  \begin{singlespace}
  Submitted to \\
  Michigan State University \\
  in partial fulfillment of the requirements\\
   for the degree of \\
  \end{singlespace}
  \doublespacing
  \begin{singlespace}
   #3 - #4 \\
  % #5 - Dual Major \\
   \end{singlespace}
    \doublespacing
   %#6 \\
   #5
 \end{center}
 \vfill

}

%%% Abstract %%%
\def\startabstractpage#1#2{% This formats the optional in-dissertation abstract - jg
 \newpage
  %\ttlpg
  \pagestyle{empty}
 %\addcontentsline{toc}{chapter}{ABSTRACT}
 \@restonecolfalse\if@twocolumn\@restonecoltrue\onecolumn\fi
 %\hbox{ }
 %\twoinmar
 
  %\doublespacing
 %\begin{center}
  \begin{singlespace}
  \centerline{\bf ABSTRACT}
   \center{#1}
  \end{singlespace}
   \doublespacing
   \centerline{By}
    \doublespacing
    \centerline{#2} 
 %\end{center}
  %\doublespacing
}


\def\initializefrontsections{
 \setcounter{page}{1}   % -- begins with "ii"
 \pagestyle{chappage}   % -- numbers at bottom
 \renewcommand{\thepage}{\roman{page}}   % roman numeral
}

\def\frontispiece{
 \ttlpg
 \hbox{ }
 \if@twoside \clearpage\hbox{}\thispagestyle{empty} \fi
 \twoinmar
}


%%% Copyright Page %%%

\def\copyrightpage#1#2{
 \ttlpg
 \hbox{ }
 \vertadjust
 \vfill
 \begin{center}
  \begin{singlespace}
  \begin{flushleft}
   Copyright by\\
   \MakeUppercase{#1} \\
   #2
   \end{flushleft}
  \end{singlespace}
 \end{center}
 \vfill
}

%%%  Dedication Page  %%%

\def\dedicationpage#1{
 \newpage
 %\addcontentsline{toc}{chapter}{DEDICATION}
 \hbox{ }
 \vertadjust
 \vfill
 \begin{center}
    \begin{singlespace}
        #1
    \end{singlespace}
 \end{center}
 \vfill
}

%%% acknowledgements page %%%

\def\startacknowledgementspage{
 \newpage
 %\addcontentsline{toc}{chapter}{ACKNOWLEDGEMENTS}
 %\hbox{ }
 \twoinmar
 \centerline{\bf ACKNOWLEDGEMENTS}
 \vspace{0.25in}
}


%-- Table of contents and lists --

\def\dotfill{\leaders\hbox{$\m@th \mkern \@dotsep mu.\mkern \@dotsep mu$}\hfill}
\def\producetableofcontents{\tableofcontents}
\def\producelistoffigures{\listoffigures}
\def\producelistoftables{\listoftables}
\def\producelistofalgms{\listofalgms}


\def\l@chapter#1#2{\pagebreak[3]
 \vskip 1.0em plus 1pt \@tempdima 1.5em \begingroup % em is the width of capital M for the current font. 
 \parindent \z@ \rightskip \@pnumwidth
 \parfillskip -\@pnumwidth
 {\bf \leavevmode #1}\dotfill \hbox to\@pnumwidth{\hss #2}\par
 \endgroup
}

\def\l@chap{\@dottedtocline{1}{-0.3em}{1.5em}}
\def\l@section{\@dottedtocline{2}{5.0em}{2.3em}}
\def\l@subsection{\@dottedtocline{3}{8.3em}{3.2em}}
\def\l@subsubsection{\@dottedtocline{4}{12.5em}{4.1em}}

\def\l@listchap{
 \vskip 1.0em plus 1pt \@tempdima 1.5em 
 \bf
 \@dottedtocline{1}{-0.3em}{1.5em}
 %\parindent \z@ \rightskip \@pnumwidth   
}

\setcounter{tocdepth}{3} % Number of section layers to show in TOC (i.e. section, subsection, subsubsection)
\setcounter{secnumdepth}{3} % Number of subsection layers to allow in document


\def\l@figure{\@dottedtocline{1}{1.0em}{3.5em}}
\let\l@table\l@figure
\let\l@map\l@figure
\let\l@anything\l@figure
\def\l@appendix{\@dottedtocline{1}{1.0em}{2.5em}}
\let\l@abbreviation\l@figure

\def\tableofcontents{%
 \newpage
 \@restonecolfalse\if@twocolumn\@restonecoltrue\onecolumn\fi
 %\hbox{ }
 \twoinmar
 \centerline{\bf TABLE OF CONTENTS}
  \vspace{0.2in}
 \begin{singlespace}
  \@starttoc{toc}\if@restonecol\twocolumn\fi
 \end{singlespace} 
}

\def\listoffigures{%
 \newpage
 \addcontentsline{toc}{listchap}{LIST OF FIGURES}
 \@restonecolfalse\if@twocolumn\@restonecoltrue\onecolumn\fi
 %\hbox{ }
 \twoinmar
 \centerline{\bf LIST OF FIGURES}
  \vspace{0.2in}
 \begin{singlespace}
 \@starttoc{lof}\if@restonecol\twocolumn\fi
 \end{singlespace}
}
  
\def\listoftables{%
 \newpage
 \addcontentsline{toc}{listchap}{LIST OF TABLES}
 \@restonecolfalse\if@twocolumn\@restonecoltrue\onecolumn\fi
 %\hbox{ }
 \twoinmar
 \centerline{\bf LIST OF TABLES}
   \vspace{0.2in}
 \begin{singlespace}
  \@starttoc{lot}\if@restonecol\twocolumn\fi
 \end{singlespace}
}  

  
\def\listofalgms{%
 \newpage
 \addcontentsline{toc}{listchap}{LIST OF ALGORITHMS}
 \@restonecolfalse\if@twocolumn\@restonecoltrue\onecolumn\fi
 %\hbox{ }
 %\twoinmar
 \centerline{\bf LIST OF ALGORITHMS}
 \vspace{0.2in}
  \doublespacing
 %\begin{singlespace}
 %\singlespacing
  \@starttoc{loa}\if@restonecol\twocolumn\fi
 %\end{singlespace}
}

%\let\oldlistoffigures\listoffigures
%\let\oldlistoftables\listoftables
%\let\oldlistofalgms\listofalgms

%\renewcommand{\listoffigures}{%
%  \begingroup%
%  \let\oldnumberline\numberline%
%  \renewcommand{\numberline}{\figurename~\oldnumberline}%
%  \oldlistoffigures%
%  \endgroup}%
  
%\renewcommand{\listoftables}{%
%  \begingroup%
%  \let\oldnumberline\numberline%
%  \renewcommand{\numberline}{\tablename~\oldnumberline}%
%  \oldlistoftables%
%  \endgroup}%
  
%\renewcommand{\listofalgms}{%
%  \begingroup%
%  \let\oldnumberline\numberline%
%  \renewcommand{\numberline}{Algorithm~\oldnumberline}%
%  \oldlistofalgms%
%  \endgroup}%
  

%-- Start chapters --

\def\thechapter {\arabic{chapter}}
\def\thesection {\@arabic\c@chapter.\@arabic\c@section}
\def\thefigure {\@arabic\c@chapter.\@arabic\c@figure}
\def\thetable {\@arabic\c@chapter.\@arabic\c@table}
\def\theequation {\@arabic\c@chapter.\@arabic\c@equation}

\newcounter{map}[chapter]
\def\themap{\@arabic\c@chapter.\@arabic\c@map}
\def\fps@map{tbp}
\def\ftype@map{1}
\def\ext@map{lom}
\def\fnum@map{Map \themap}
\def\map{\@float{map}}
\let\endmap\end@float
\@namedef{map*}{\@dblfloat{map}}
\@namedef{endmap*}{\end@dblfloat}

\def\startthechapters{%
 \def\@chapapp{CHAPTER}
%\addtocontents{toc}{\protect\mbox{ }\protect\newline\noindent{\bf CHAPTER}\protect\newline}
 \addtocontents{toc}{}
 
 \clearpage % This has to be before the rest.  jj
 \if@twoside \ifodd\c@page \else \ttlpg \hbox{ }\fi\fi % For two-sided printing, make sure Chapter I starts on right-hand page. jg
 \clearpage
 \setcounter{chapter}{0}
 \setcounter{page}{1} % -- ...always begin with ii.
 \renewcommand{\thepage}{\arabic{page}}
 \pagestyle{plain}
 \def\tocname{toc}
}

\def\@chapter[#1]#2{%
 \ifnum \c@secnumdepth >\m@ne
  \refstepcounter{chapter}
  \typeout{\@chapapp\space\thechapter.}
  \addtocontents{toc}{\hbox{ }}
  \addcontentsline{toc}{chap}{\protect\numberline{\hbox{ }\hfill\bf\@chapapp{} \thechapter : }{\hspace{1in}\bf #1}}
  \addtocontents{toc}{}
 \else
  \addtocontents{toc}{\hbox{ }}
  \addcontentsline{toc}{chap}{#1}
  \addtocontents{toc}{}
 \fi
 \if@twocolumn \@topnewpage[\@makechapterhead{#2}]
 \else \@makechapterhead{#2} \@afterheading \fi
}

\def\@makechapterhead#1{%
 \hbox{ }
 \twoinmar
 {\parindent 0pt \raggedright
  \ifnum \c@secnumdepth >\m@ne
  \centerline{\large\bf \@chapapp{} \thechapter : #1} \par
  \vskip 0.3in \fi
 }
 \@afterindenttrue
}

\def\section{\@startsection{section}{1}{\z@}{3.5ex plus 1ex minus
 .2ex}{2.3ex plus .2ex}{\large\bf}}
\def\subsection{\@startsection{subsection}{2}{\z@}{3.25ex plus 1ex minus
 .2ex}{1.5ex plus .2ex}{\normalsize\bf}}
\def\subsubsection{\@startsection{subsubsection}{3}{\z@}{3.25ex plus
 1ex minus .2ex}{1.5ex plus .2ex}{\normalsize\bf}}

\long\def\@caption#1[#2]#3{%
 \addtocontents{\csname ext@#1\endcsname}{\hbox{ }}
 \addcontentsline{\csname ext@#1\endcsname}{#1}{\protect\numberline{\csname
  the#1\endcsname}{\ignorespaces\protect\small\protect\normalsize\rm #2}}
 \par
 \begingroup
  \@parboxrestore
  \@makecaption{\csname fnum@#1\endcsname}{\ignorespaces\protect\small\normalsize\rm #3}
  \par
 \endgroup
}

\long\def\@makecaption#1#2{
 \vskip 10pt
 \setbox\@tempboxa\hbox{#1: #2}
 \ifdim \wd\@tempboxa >\hsize
  \setbox\@tempboxa\hbox{#1: }
  \def\@tempdimj{\hsize}
  \advance\@tempdimj -\wd\@tempboxa
  \hbox to\hsize{#1: \parbox[t]{\@tempdimj}{#2}}
 \else \hbox to\hsize{\hfill\box\@tempboxa\hfill}
 \fi}

%-bibliography --

\def\startbibliography{% This sets things up for BibTeX
 \clearpage
 \hbox{}
 \if@twoside \ifodd\c@page \else\thispagestyle{empty} \clearpage\hbox{} \fi\fi
 \thispagestyle{chappage}
 \addcontentsline{toc}{listchap}{BIBLIOGRAPHY}
 \hbox{ }
 \vertadjust
 \vfill
 \centerline{\large\bf BIBLIOGRAPHY} % The half title page
 \vfill
 \renewcommand{\bibname}{\vspace{-1in}\centerline{\large\bf BIBLIOGRAPHY}\vspace{-0.2in}}
 
 %\newpage
% \twoinmar
 %\centerline{\bf BIBLIOGRAPHY}
 %  \vspace{0.3in}
}

